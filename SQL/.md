# Insights Using MySQL
SQL queries and it's results
--------------------------------------------------------------------------------------------------------------------------------------
USE pizza;
## Sales performance analysis(top 10-selling and least-selling pizzas)
SELECT pizza_name, pizza_category, pizza_size, SUM(quantity) AS quantity, ROUND(SUM(total_price),0) AS revenue FROM pizza_sales GROUP BY pizza_name, pizza_category, pizza_size ORDER BY revenue desc limit 10;


![MySQL 1](https://github.com/user-attachments/assets/41129f06-60e0-4f30-9711-7e3a86a1df2f)



SELECT pizza_name, pizza_category, pizza_size, SUM(quantity) AS quantity, ROUND(SUM(total_price),0) AS revenue FROM pizza_sales GROUP BY pizza_name, pizza_category, pizza_size ORDER BY revenue  limit 10;


![MySQL 2](https://github.com/user-attachments/assets/1c524c38-c438-4354-a8dc-c67d5b2ff2e4)


## Revenue Trends and seasonality
### Peak sale hours
SELECT hour(order_time) AS order_hour, COUNT(DISTINCT order_id) AS total_orders, ROUND(SUM(total_price),0) AS total_revenue FROM pizza_sales GROUP BY order_hour ORDER BY total_orders DESC;


![MySQL 3](https://github.com/user-attachments/assets/73ff27ad-3b03-409a-8bd0-059f5f2298e1)



### Order frequency by day of week
SELECT order_day, COUNT(DISTINCT order_id) AS total_orders, ROUND(SUM(total_price),0) AS revenue FROM pizza_sales GROUP BY order_day ORDER BY total_orders DESC;


![MySQL 4](https://github.com/user-attachments/assets/7d3e7390-bf33-48a2-931b-684f0e17b76b)



### Sales trends over seasonality by analyzing the total orders every month
SELECT DATE_FORMAT(STR_TO_DATE(order_date, '%m/%d/%Y'), '%M') AS `Month` FROM pizza_sales GROUP BY `Month` ORDER BY COUNT(DISTINCT order_id) DESC;


![MySQL 5](https://github.com/user-attachments/assets/c6ce4fdd-3265-424d-b3f3-772e123e383e)



## Customer Preferences and order pattern analysis
## Customer spending behavior:
### average orders
SELECT order_id, COUNT(DISTINCT order_id) AS total_orders, SUM(total_price) AS total_spent, ROUND(AVG(total_price),2) AS avg_spent FROM pizza_sales GROUP BY order_id ORDER BY total_spent DESC, avg_spent DESC limit 10;


![MySQL6](https://github.com/user-attachments/assets/ddeca0fd-b115-4da9-ac57-91ed62428397)




### Customer spending behavior based on pizza category
SELECT pizza_category, COUNT(DISTINCT order_id) AS total_pizzas_category_ordered FROM pizza_sales GROUP BY pizza_category ORDER BY total_pizzas_category_ordered DESC;


![MySQL 7](https://github.com/user-attachments/assets/1746bc60-4e43-483d-82df-431d8d74cb41)



### Percentage of sales by pizza category
SELECT pizza_category, ROUND(SUM(total_price),0) AS Total_sales, CONCAT(ROUND((SUM(total_price)*100/(SELECT SUM(total_price) FROM pizza_sales)),2),'%') AS Percentage FROM pizza_sales GROUP BY pizza_category ORDER BY Total_sales DESC;


![MySQL8](https://github.com/user-attachments/assets/5331377a-d7e1-48d4-b509-d762201bcbe9)




### Percentage of sales by pizza size
SELECT pizza_size, ROUND(SUM(total_price),0) AS Total_sales, CONCAT(ROUND((SUM(total_price)*100/(SELECT SUM(total_price) FROM pizza_sales)),2),'%') AS Percentage FROM pizza_sales GROUP BY pizza_size ORDER BY Total_sales DESC;


![MySQL 9](https://github.com/user-attachments/assets/1b8da890-ab72-4c97-8749-f49c3516af9b)



### Customer spending behavior based on size of pizza
SELECT pizza_size, COUNT(DISTINCT order_id) AS total_orders FROM pizza_sales GROUP BY pizza_size ORDER BY total_orders DESC;


![MySQL 10](https://github.com/user-attachments/assets/966d3e14-b7cf-4885-9b0c-920c05973032)




### Frequent Order Combinations
SELECT a.pizza_name AS pizza_1, b.pizza_name AS pizza_2, COUNT(*) AS ordered_together FROM pizza_sales a JOIN pizza_sales b ON a.order_id=b.order_id AND a.pizza_name< b.pizza_name GROUP BY pizza_1, pizza_2 ORDER BY ordered_together DESC LIMIT 10;


![MySQL 11](https://github.com/user-attachments/assets/09c06067-bb42-40e3-9ccb-81b3618bb08c)




## Profitability Analysis

### Gross profit and Profit margin per pizza
SELECT pizza_name, SUM(quantity) AS quantity,ROUND((SUM(total_price)-SUM(unit_price)),0) AS Gross_profit, CONCAT(ROUND(((SUM(total_price)-SUM(unit_price))/(SUM(total_price))*100),2),'%') AS Profit_margin FROM pizza_sales GROUP by pizza_name ORDER BY Gross_profit DESC LIMIT 10;


![MySQL 12](https://github.com/user-attachments/assets/c7ce5920-6f05-4d91-beb4-f28744d6c3f7)



### Revenue generated by pizza size
SELECT pizza_size, SUM(quantity) AS quantity, ROUND(SUM(total_price),0) AS revenue_generated FROM pizza_sales GROUP BY pizza_size ORDER BY revenue_generated DESC;


![MySQL 13](https://github.com/user-attachments/assets/96898df6-145c-494c-bd95-5b1f3c924b23)



### Revenue generated by pizza category
SELECT pizza_category, SUM(quantity) AS quantity, ROUND(SUM(total_price),0) AS revenue_generated FROM pizza_sales GROUP BY pizza_category ORDER BY revenue_generated DESC;

![MySQL 14](https://github.com/user-attachments/assets/ac77961e-3605-476b-b9e8-10a3c1774351)




